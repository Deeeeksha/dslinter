<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Data Leakage | DSLinter - Linter for Machine Learnig Application - Specific Code Smells</title>
<meta name=keywords content="can be automated,">
<meta name=description content="Description &ldquo;Data Leakage happens when the data you are using to train a machine learning algorithm happens to have the information you are trying to predict.&#34;\ref{grey:data_leakage} It results in overly optimistic performance during testing and poor performance in real-world usage. There are two main sources of data leakage: leaky predictors and a leaky validation strategy \ref{grey:data_leakage_kaggle}. Leaky predictors refer to the situation where some features updated or created after the target value is realized are included.">
<meta name=author content>
<link rel=canonical href=https://hynn01.github.io/dslinter/code-smells/data-leakage/>
<meta name=google-site-verification content="XYZabc">
<meta name=yandex-verification content="XYZabc">
<meta name=msvalidate.01 content="XYZabc">
<link crossorigin=anonymous href=/dslinter/assets/css/stylesheet.min.ccf63c2001f333f5fe878d473648051efe3aea1e5baceba8797e9f94daa448e6.css integrity="sha256-zPY8IAHzM/X+h41HNkgFHv466h5brOuoeX6flNqkSOY=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/dslinter/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://hynn01.github.io/dslinter/%3Clink%20/%20abs%20url%3E>
<link rel=icon type=image/png sizes=16x16 href=https://hynn01.github.io/dslinter/%3Clink%20/%20abs%20url%3E>
<link rel=icon type=image/png sizes=32x32 href=https://hynn01.github.io/dslinter/%3Clink%20/%20abs%20url%3E>
<link rel=apple-touch-icon href=https://hynn01.github.io/dslinter/%3Clink%20/%20abs%20url%3E>
<link rel=mask-icon href=https://hynn01.github.io/dslinter/%3Clink%20/%20abs%20url%3E>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.91.1">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript><meta property="og:title" content="Data Leakage">
<meta property="og:description" content="Description &ldquo;Data Leakage happens when the data you are using to train a machine learning algorithm happens to have the information you are trying to predict.&#34;\ref{grey:data_leakage} It results in overly optimistic performance during testing and poor performance in real-world usage. There are two main sources of data leakage: leaky predictors and a leaky validation strategy \ref{grey:data_leakage_kaggle}. Leaky predictors refer to the situation where some features updated or created after the target value is realized are included.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://hynn01.github.io/dslinter/code-smells/data-leakage/"><meta property="article:section" content="Code Smells">
<meta property="og:site_name" content="DSLinter - Linter for Machine Learnig Application - Specific Code Smells">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Data Leakage">
<meta name=twitter:description content="Description &ldquo;Data Leakage happens when the data you are using to train a machine learning algorithm happens to have the information you are trying to predict.&#34;\ref{grey:data_leakage} It results in overly optimistic performance during testing and poor performance in real-world usage. There are two main sources of data leakage: leaky predictors and a leaky validation strategy \ref{grey:data_leakage_kaggle}. Leaky predictors refer to the situation where some features updated or created after the target value is realized are included.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Data Leakage","item":"https://hynn01.github.io/dslinter/code-smells/data-leakage/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Data Leakage","name":"Data Leakage","description":"Description \u0026ldquo;Data Leakage happens when the data you are using to train a machine learning algorithm happens to have the information you are trying to predict.\u0026quot;\\ref{grey:data_leakage} It results in overly optimistic performance during testing and poor performance in real-world usage. There are two main sources of data leakage: leaky predictors and a leaky validation strategy \\ref{grey:data_leakage_kaggle}. Leaky predictors refer to the situation where some features updated or created after the target value is realized are included.","keywords":["can be automated",""],"articleBody":"Description â€œData Leakage happens when the data you are using to train a machine learning algorithm happens to have the information you are trying to predict.\"\\ref{grey:data_leakage} It results in overly optimistic performance during testing and poor performance in real-world usage. There are two main sources of data leakage: leaky predictors and a leaky validation strategy \\ref{grey:data_leakage_kaggle}. Leaky predictors refer to the situation where some features updated or created after the target value is realized are included. This kind of data leakage can only be inspected at the data level rather than the code level. Leaky validation strategy refers to the scene where information from training data is getting mixed with validation data. This kind of pitfall can be avoided by checking the code carefully. One best practice in Scikit-Learn is to use Pipeline API to prevent data leakage.\nType Generic\nExisting Stage Data Preparation\nEffect Error-prone\nExample ### Scikit-Learn import numpy as np from sklearn.feature_selection import SelectPercentile, f_regression from sklearn.linear_model import Ridge from sklearn.model_selection import cross_val_score rnd = np.random.RandomState(seed=0) X = rnd.normal(size=(100, 10000)) y = rnd.normal(size=(100,)) # Violated Code select = SelectPercentile(score_func=f_regression, percentile=5).fit(X, y) X_selected = select.transform(X) accuracy = np.mean(cross_val_score(Ridge(), X_selected, y, cv=5)) # Recommended Fix select = SelectPercentile(score_func=f_regression, percentile=5) pipe = Pipeline([(\"select\", select), (\"ridge\", Ridge())]) accuracy = np.mean(cross_val_score(pipe, X, y, cv=5)) Source: Paper  MPA Haakman. 2020. Studying the Machine Learning Lifecycle and ImprovingCode Quality of Machine Learning Applications. (2020).  Grey Literature GitHub Commit Stack Overflow  https://stackoverflow.com/questions/43816718/keras-regression-using-scikit-learn-standardscaler-with-pipeline-and-without-pip/43816833#43816833  Documentation  https://scikit-learn.org/stable/common_pitfalls.html  ","wordCount":"239","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://hynn01.github.io/dslinter/code-smells/data-leakage/"},"publisher":{"@type":"Organization","name":"DSLinter - Linter for Machine Learnig Application - Specific Code Smells","logo":{"@type":"ImageObject","url":"https://hynn01.github.io/dslinter/%3Clink%20/%20abs%20url%3E"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://hynn01.github.io/dslinter/ accesskey=h title="DSLinter - Linter for Machine Learnig Application - Specific Code Smells (Alt + H)">DSLinter - Linter for Machine Learnig Application - Specific Code Smells</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://hynn01.github.io/dslinter/code-smells/ title="Code Smells">
<span>Code Smells</span>
</a>
</li>
<li>
<a href=https://hynn01.github.io/dslinter/ title=Survey>
<span>Survey</span>
</a>
</li>
<li>
<a href=https://hynn01.github.io/dslinter/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://hynn01.github.io/dslinter/>Home</a></div>
<h1 class=post-title>
Data Leakage
</h1>
<div class=post-meta>
</div>
</header>
<div class=post-content><h3 id=description>Description<a hidden class=anchor aria-hidden=true href=#description>#</a></h3>
<p>&ldquo;Data Leakage happens when the data you are using to train a machine learning algorithm happens to have the information you are trying to predict."\ref{grey:data_leakage} It results in overly optimistic performance during testing and poor performance in real-world usage. There are two main sources of data leakage: leaky predictors and a leaky validation strategy \ref{grey:data_leakage_kaggle}. Leaky predictors refer to the situation where some features updated or created after the target value is realized are included. This kind of data leakage can only be inspected at the data level rather than the code level. Leaky validation strategy refers to the scene where information from training data is getting mixed with validation data. This kind of pitfall can be avoided by checking the code carefully. One best practice in Scikit-Learn is to use Pipeline API to prevent data leakage.</p>
<h3 id=type>Type<a hidden class=anchor aria-hidden=true href=#type>#</a></h3>
<p>Generic</p>
<h3 id=existing-stage>Existing Stage<a hidden class=anchor aria-hidden=true href=#existing-stage>#</a></h3>
<p>Data Preparation</p>
<h3 id=effect>Effect<a hidden class=anchor aria-hidden=true href=#effect>#</a></h3>
<p>Error-prone</p>
<h3 id=example>Example<a hidden class=anchor aria-hidden=true href=#example>#</a></h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#75715e>### Scikit-Learn</span>

<span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
<span style=color:#f92672>from</span> sklearn.feature_selection <span style=color:#f92672>import</span> SelectPercentile, f_regression
<span style=color:#f92672>from</span> sklearn.linear_model <span style=color:#f92672>import</span> Ridge
<span style=color:#f92672>from</span> sklearn.model_selection <span style=color:#f92672>import</span> cross_val_score
rnd <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>RandomState(seed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
X <span style=color:#f92672>=</span> rnd<span style=color:#f92672>.</span>normal(size<span style=color:#f92672>=</span>(<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>10000</span>))
y <span style=color:#f92672>=</span> rnd<span style=color:#f92672>.</span>normal(size<span style=color:#f92672>=</span>(<span style=color:#ae81ff>100</span>,))

<span style=color:#75715e># Violated Code</span>
select <span style=color:#f92672>=</span> SelectPercentile(score_func<span style=color:#f92672>=</span>f_regression, percentile<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>)<span style=color:#f92672>.</span>fit(X, y)
X_selected <span style=color:#f92672>=</span> select<span style=color:#f92672>.</span>transform(X)
accuracy <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>mean(cross_val_score(Ridge(), X_selected, y, cv<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>))

<span style=color:#75715e># Recommended Fix</span>
select <span style=color:#f92672>=</span> SelectPercentile(score_func<span style=color:#f92672>=</span>f_regression, percentile<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>)
pipe <span style=color:#f92672>=</span> Pipeline([(<span style=color:#e6db74>&#34;select&#34;</span>, select), (<span style=color:#e6db74>&#34;ridge&#34;</span>, Ridge())])
accuracy <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>mean(cross_val_score(pipe, X, y, cv<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>))

</code></pre></div><h3 id=source>Source:<a hidden class=anchor aria-hidden=true href=#source>#</a></h3>
<h4 id=paper>Paper<a hidden class=anchor aria-hidden=true href=#paper>#</a></h4>
<ul>
<li>MPA Haakman. 2020. Studying the Machine Learning Lifecycle and ImprovingCode Quality of Machine Learning Applications. (2020).</li>
</ul>
<h4 id=grey-literature>Grey Literature<a hidden class=anchor aria-hidden=true href=#grey-literature>#</a></h4>
<h4 id=github-commit>GitHub Commit<a hidden class=anchor aria-hidden=true href=#github-commit>#</a></h4>
<h4 id=stack-overflow>Stack Overflow<a hidden class=anchor aria-hidden=true href=#stack-overflow>#</a></h4>
<ul>
<li><a href=https://stackoverflow.com/questions/43816718/keras-regression-using-scikit-learn-standardscaler-with-pipeline-and-without-pip/43816833#43816833>https://stackoverflow.com/questions/43816718/keras-regression-using-scikit-learn-standardscaler-with-pipeline-and-without-pip/43816833#43816833</a></li>
</ul>
<h4 id=documentation>Documentation<a hidden class=anchor aria-hidden=true href=#documentation>#</a></h4>
<ul>
<li><a href=https://scikit-learn.org/stable/common_pitfalls.html>https://scikit-learn.org/stable/common_pitfalls.html</a></li>
</ul>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://hynn01.github.io/dslinter/tags/can-be-automated/>can be automated</a></li>
</ul>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://hynn01.github.io/dslinter/>DSLinter - Linter for Machine Learnig Application - Specific Code Smells</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>